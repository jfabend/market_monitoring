# fill up the na values by their former values
# (The colnames stay the same afterwards)
p2:
  func: fill_na_with_last_value
  cols:
    - "c_fed_funds_rate__value"
    - "c_ted_spread_credit_risk__value" #1986
    - "c_us_bond_1year__value" #1988
    - "c_usa_bond_10year__value"
    - c_us_bond_30years__close
    - "c_bearmarket_days__value"
    - "c_sp500__close"
p11:
  func: set_col_dtype
  cols:
    - "c_fed_funds_rate__value"
    - "c_ted_spread_credit_risk__value" #1986
    - "c_us_bond_1year__value" #1988
    - "c_usa_bond_10year__value"
    - c_us_bond_30years__close
    - "c_sp500__close"
  dtype: float
p15:
  func: two_cols_percent_delta
  base_col: c_us_bond_30years__close
  second_col: c_us_bond_1year__value
  new_col: bond_perc_1_30
p16:
  func: two_cols_percent_delta
  base_col: c_us_bond_30years__close
  second_col: c_usa_bond_10year__value
  new_col: bond_perc_10_30
p17:
  func: two_cols_percent_delta
  base_col: c_usa_bond_10year__value
  second_col: c_us_bond_1year__value
  new_col: bond_perc_10_1
p73:
  func: drop_na_rows
  special_col: dim_time_date
p72:
  func: drop_na_rows
  special_col: c_fed_funds_rate__value
p92:
  func: drop_na_rows
  special_col: bond_perc_1_30
p91:
  func: drop_na_rows
  special_col: bond_perc_10_30
p90:
  func: drop_na_rows
  special_col: bond_perc_10_1
p97:
  func: lin_reg_of_col
  X_cols: dim_time_date
  y_col: bond_perc_1_30
  new_colname: linreg_bond_perc_1_30
p98:
  func: lin_reg_of_col
  X_cols: dim_time_date
  y_col: bond_perc_10_30
  new_colname: linreg_bond_perc_10_30
p99:
  func: lin_reg_of_col
  X_cols: dim_time_date
  y_col: bond_perc_10_1
  new_colname: linreg_bond_perc_10_1
p95:
  func: new_col_substract
  base_col: bond_perc_1_30
  sub_col: linreg_bond_perc_1_30
  new_col: bond_perc_1_30_notrend
p94:
  func: new_col_substract
  base_col: bond_perc_10_30
  sub_col: linreg_bond_perc_10_30
  new_col: bond_perc_10_30_notrend
p93:
  func: new_col_substract
  base_col: bond_perc_10_1
  sub_col: linreg_bond_perc_10_1
  new_col: bond_perc_10_1_notrend
p18:
  func: lin_reg_of_col
  X_cols: dim_time_date
  y_col: c_fed_funds_rate__value
  new_colname: linreg_fed_funds_rate
p22:
  func: new_col_substract
  base_col: c_fed_funds_rate__value
  sub_col: linreg_fed_funds_rate
  new_col: fed_funds_rate_notrend
p27:
  func: rolling_mean
  cols: fed_funds_rate_notrend
  days: 300
p28:
  func: rolling_mean
  cols:
    - bond_perc_1_30_notrend
    - bond_perc_10_30_notrend
    - bond_perc_10_1_notrend
  days: 300
p29:
  func: rolling_mean
  cols:
    - bond_perc_1_30_notrend
    - bond_perc_10_30_notrend
    - bond_perc_10_1_notrend
  days: 600
p55:
  func: drop_na_rows
  special_col: 'c_bearmarket_days__value'
p76:
  func: remove_if_smaller
  cols: dim_time_year
  value: 1962
p75:
  func: remove_if_greater
  cols: dim_time_year
  value: 2021