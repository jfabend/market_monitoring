# fill up the na values by their former values
# (The colnames stay the same afterwards)
p2:
  func: fill_na_with_last_value
  cols:
    - "c_fed_funds_rate__value"
    - "c_ted_spread_credit_risk__value" #1986
    - "c_usa_bond_2year__open" #1988
    - "c_usa_bond_10year__open"
    - "c_inflation_rate__value"
    - "c_m2_growth__value"
    - "c_sp500_bonds_return_ratio__value"
    - "c_sp500_pe_ratio__value"
    - "c_us_corporate_dept_to_gdp__value"
    - "c_us_return_aaa_corporate_vs_bonds__value"
    - "c_us_return_baa_corporate_vs_bonds__value"
    - "c_bearmarket_days__value"
    - c_large_small_cap_ratio__value
    - "c_sp500__close"
p225:
  func: drop_na_rows
  special_col: c_m2_growth__value
p226:
  func: drop_na_rows
  special_col: c_inflation_rate__value
p3:
  func: set_col_dtype
  cols:
    - c_m2_growth__value
    - c_inflation_rate__value
    - c_us_return_aaa_corporate_vs_bonds__value
    - c_us_corporate_dept_to_gdp__value
  dtype: float
p11:
  func: new_col_substract
  base_col: c_m2_growth__value
  sub_col: c_inflation_rate__value
  new_col: m2growth_inflation_spread
p12:
  func: new_col_substract
  base_col: c_usa_bond_10year__open
  sub_col: c_usa_bond_2year__open
  new_col: bond_spread
p13:
  func: rolling_mean
  cols: bond_spread
  days: 600
p14:
  func: rolling_mean
  cols: m2growth_inflation_spread
  days: 90
p15:
  func: rolling_mean
  cols: m2growth_inflation_spread
  days: 180
p16:
  func: rolling_mean
  cols: c_us_return_baa_corporate_vs_bonds__value
  days: 90
p17:
  func: rolling_mean
  cols: c_us_return_baa_corporate_vs_bonds__value
  days: 60
p73:
  func: drop_na_rows
  special_col: dim_time_date
p72:
  func: drop_na_rows
  special_col: c_fed_funds_rate__value
p18:
  func: lin_reg_of_col
  X_cols: dim_time_date
  y_col: c_fed_funds_rate__value
  new_colname: linreg_fed_funds_rate
p22:
  func: new_col_substract
  base_col: c_fed_funds_rate__value
  sub_col: linreg_fed_funds_rate
  new_col: fed_funds_rate_notrend
p27:
  func: rolling_mean
  cols: fed_funds_rate_notrend
  days: 300
p23:
  func: lin_reg_of_col
  X_cols: dim_time_date
  y_col: c_us_return_aaa_corporate_vs_bonds__value
  new_colname: linreg_return_aaa_corporate_vs_bonds
p24:
  func: new_col_substract
  base_col: c_us_return_aaa_corporate_vs_bonds__value
  sub_col: linreg_return_aaa_corporate_vs_bonds
  new_col: return_aaa_corporate_vs_bonds_notrend
p25:
  func: lin_reg_of_col
  X_cols: dim_time_date
  y_col: c_us_corporate_dept_to_gdp__value
  new_colname: linreg_dept_to_gdp
p26:
  func: new_col_substract
  base_col: c_us_corporate_dept_to_gdp__value
  sub_col: linreg_dept_to_gdp
  new_col: dept_to_gdp_notrend
p48:
  func: rolling_mean
  cols: dept_to_gdp_notrend
  days: 70
p49:
  func: rolling_mean
  cols: dept_to_gdp_notrend
  days: 150
p40:
  func: rolling_mean
  cols: dept_to_gdp_notrend
  days: 300
p41:
  func: rolling_mean
  cols: dept_to_gdp_notrend
  days: 600
p58:
  func: rolling_mean
  cols: c_us_corporate_dept_to_gdp__value
  days: 70
p29:
  func: rolling_mean
  cols: c_us_corporate_dept_to_gdp__value
  days: 150
p30:
  func: rolling_mean
  cols: c_us_corporate_dept_to_gdp__value
  days: 300
p31:
  func: rolling_mean
  cols: c_us_corporate_dept_to_gdp__value
  days: 600
p32:
  func: rolling_mean
  cols: c_large_small_cap_ratio__value
  days: 180
p33:
  func: rolling_mean
  cols: c_large_small_cap_ratio__value
  days: 90
p34:
  func: rolling_mean
  cols: c_large_small_cap_ratio__value
  days: 60
p35:
  func: rolling_mean
  cols: c_large_small_cap_ratio__value
  days: 30
p36:
  func: rolling_mean
  cols: c_large_small_cap_ratio__value
  days: 20
p37:
  func: rolling_mean
  cols: c_large_small_cap_ratio__value
  days: 10
p38:
  func: min_max_channel_cols
  col: c_us_corporate_dept_to_gdp__value
  n_points: 900
p39:
  func: min_max_channel_cols
  col: c_large_small_cap_ratio__value
  n_points: 600
p77:
  func: drop_na_rows
  special_col: 'c_bearmarket_days__value'
p76:
  func: remove_if_smaller
  cols: dim_time_year
  value: 1978
p75:
  func: remove_if_greater
  cols: dim_time_year
  value: 2021